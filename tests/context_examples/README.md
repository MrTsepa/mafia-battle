# LLM Context Examples

This directory contains example prompts that are passed to the LLM for each type of action in the Mafia game.

## Generated Files

These files are automatically generated by running:

```bash
pytest tests/test_llm_context_examples.py -v -s
```

### File Descriptions

- **`day_speech_prompt.txt`** - Context passed when a player makes a day speech
- **`final_speech_prompt.txt`** - Context passed when an eliminated player makes their final speech
- **`sheriff_check_prompt.txt`** - Context passed when the Sheriff checks a player at night
- **`don_check_prompt.txt`** - Context passed when the Don checks a player at night
- **`kill_claim_prompt.txt`** - Context passed when a mafia player suggests a kill target
- **`kill_decision_prompt.txt`** - Context passed when the Don makes the final kill decision

## Key Features Verified

All prompts include:

1. **Complete Day Speeches** - All speeches from current day and previous days (2-3 days)
2. **Night Actions Include Day Speeches** - Night actions (checks, kills) now include all day speeches, not just eliminations
3. **Previous Night Kills** - Clear history of who was killed each night
4. **Eliminations** - All eliminations with reasons and days
5. **Vote Information** - Clear "who-voted-for-whom" format
6. **Check Results** - Previous check results for Sheriff and Don
7. **Role-Specific Information** - Mafia team knowledge, check results, etc.

## Context Structure

Each prompt follows this structure:

1. **Player Identity** - Role, team, player number
2. **Game Rules** - Basic game mechanics
3. **Role-Specific Info** - Abilities, check results, mafia team (if applicable)
4. **Game State** - Current phase, day/night numbers, alive players
5. **Game Structure** - Contextual guidance based on day number
6. **Alive Players** - List with suspicious/trusted markers
7. **Voting Patterns** - Analysis of suspicious players and coordinated votes
8. **Day Speeches** - All speeches from current and previous days
9. **Nominations** - Who was nominated each day
10. **Votes** - Who voted for whom (clear format)
11. **Eliminations** - All eliminations with reasons
12. **Previous Night Kills** - History of night kills
13. **Action-Specific Instructions** - What the LLM should do

## Verification

The test verifies that:
- ✅ All required sections are present
- ✅ Day speeches are included in all contexts
- ✅ Night actions include day speeches (not just eliminations)
- ✅ Vote information is clearly formatted
- ✅ Check results are included
- ✅ Night kills are shown

## Usage

To regenerate these examples:

```bash
# Run the test
pytest tests/test_llm_context_examples.py -v -s

# View a specific prompt
cat tests/context_examples/day_speech_prompt.txt
```

To see the prompts in action during a real game, check the `context` field in the `events.jsonl` files in the `runs/` directory.

